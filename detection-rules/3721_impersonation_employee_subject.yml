name: "PR# 3721 - BEC: Employee impersonation with subject manipulation"
description: |
  Subject matches the display name of someone in your organization, and the body resembles a BEC attack.
type: "rule"
severity: "high"
source: |
  type.inbound

  // attacks have been observed where the impersonation is
  // in the subject, and the display name contains what a
  // subject typically would contain. this is an attempt to
  // bypass impersonation detections
  and subject.base in~ $org_display_names
  and any(ml.nlu_classifier(body.current_thread.text).intents,
          .name == "bec" and .confidence in ("medium", "high")
  )
  and (
    not profile.by_sender().solicited
    or (
      profile.by_sender().any_messages_malicious_or_spam
      and not profile.by_sender().any_messages_benign
    )
  )

attack_types:
  - "BEC/Fraud"
tactics_and_techniques:
  - "Impersonation: Employee"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Natural Language Understanding"
  - "Sender analysis"
id: "8460b773-845f-5209-ae97-b4a5923dd029"
tags:
  - created_from_open_prs
  - rule_status_modified
  - pr_author_D-Bolton
references:
  - https://github.com/sublime-security/sublime-rules/pull/3721