name: "PR# 3720 - Headers: UTF-8 base64 encoded From header"
description: "Message contains a From header that has been encoded using UTF-8 base64 encoding, which may be used to obfuscate sender information or bypass security filters."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(headers.hops,
          any(filter(.fields, .name == "From"),
              strings.istarts_with(.value, "-=?utf-8?b?")
          )
  )
tags:
  - "Attack surface reduction"
  - pr_author_MSAdministrator
  - created_from_open_prs
  - rule_status_added
attack_types:
  - "BEC/Fraud"
  - "Credential Phishing"
  - "Spam"
tactics_and_techniques:
  - "Encryption"
  - "Evasion"
  - "Spoofing"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
id: "9bfe94d9-9afe-5360-9a53-bd5099e5a5f5"
references:
  - https://github.com/sublime-security/sublime-rules/pull/3720