name: "PR# 3285 - Attachment: Calendar invite from recently registered domain"
description: "Detects calendar invites (.ics files) from organizers using domains registered within the last 90 days, which may indicate suspicious or malicious calendar invitations."
type: "rule"
severity: "high"
source: |
  type.inbound
  and length(attachments) > 0
  and all(attachments, .content_type in ("text/calendar", "application/ics"))
  and any(attachments,
          // extract the calendar invite description and use NLU against it
          any(file.explode(.),
              any(.scan.ics.calendars,
                  any(.components,
                      any(.organizers,
                          network.whois(.mailbox.email.domain).days_old < 90
                      )
                  )
              )
          )
  )

attack_types:
  - "Callback Phishing"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
detection_methods:
  - "File analysis"
  - "Whois"
id: "e63fe8a6-bba3-5acb-bf08-7423e0e6e1e1"
tags:
  - created_from_open_prs
  - rule_status_added
  - pr_author_zoomequipd
references:
  - https://github.com/sublime-security/sublime-rules/pull/3285