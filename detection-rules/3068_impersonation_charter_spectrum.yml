name: "PR# 3068 - Brand impersonation: Charter Spectrum"
description: "Detects messages impersonating Charter Spectrum by using variations of 'Spectrum' or 'MyCharter' in the display name while not originating from legitimate Charter domains or failing DMARC authentication."
type: "rule"
severity: "medium"
source: |
 type.inbound
// Claim to be Charter or Spectrum in the Display Name
and regex.icontains(sender.display_name, 'spe[c√ß]trum', 'MyCharter')
// Exclude authorized sending through legitimate sending domains
and not (
  sender.email.domain.root_domain in (
    "spectrumemails.com", // primary communication domain
    "beagleinsight.com", // survey vendor
    "spectrumreach.com", // direct marketing
    "charter.com", // service alerts
    "spectrumenterprise.com", // customer surveys
    "spectrumcustomersurvey.com", // customer feedback surveys
    "ccsend.com", // they use constant contact
    "simplifiednetworkmanagement.com" // cold emailing from this domain
  )
  and headers.auth_summary.dmarc.pass
)
// necessitated by legit emails that are failing dmarc (they probably use a vendor)
and not (
  sender.email.domain.root_domain in (
    "spectrum.com", // they use vendors that don't have dmarc pass
    "spectrum.net" // voicemail notifications - dmarc null
  )
  and headers.auth_summary.spf.pass
)

// Make sure this is related to Charter -- exclude other use of 'spectrum'
and regex.icontains(body.current_thread.text, 'Charter')

attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Sender analysis"
id: "26162949-d936-5dd7-a626-6f1b3ca41dff"
tags:
  - created_from_open_prs
  - rule_status_added
  - pr_author_ben-sublime
references:
  - https://github.com/sublime-security/sublime-rules/pull/3068