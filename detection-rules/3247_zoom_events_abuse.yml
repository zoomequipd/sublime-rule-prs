name: "PR# 3247 - Zoom Events newsletter abuse"
description: "Detects suspicious content in Zoom Events notifications that contain credential theft language and links to file hosting sites."
type: "rule"
severity: "medium"
references:
  - "https://blog.reconinfosec.com/zoom-events-phishing"
  - https://github.com/sublime-security/sublime-rules/pull/3247
source: |
  type.inbound
  and sender.email.email == "noreply-zoomevents@zoom.us"
  and headers.auth_summary.spf.pass
  
  // extract the actor controlled message from the email body
  and any(html.xpath(body.html,
                     "//div[@class='eb-content css-1l7xmti']//td[@data-dynamic-style-background-color='email.bodyColor.color' and @style='border-radius: 8px; background-color: rgb(255, 255, 255);']"
          ).nodes,
          any(html.xpath(.,
                         "//td[@data-dynamic-style-background-color='email.bodyColor.color']/*[position() < last()]"
              ).nodes,
              any(ml.nlu_classifier(..display_text).intents,
                  .name == "cred_theft" and .confidence != "low"
              )
          )
  )

attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Free file host"
  - "Free subdomain host"
  - "Social engineering"
  - "Impersonation: Brand"
detection_methods:
  - "Header analysis"
  - "HTML analysis"
  - "Natural Language Understanding"
  - "URL analysis"
id: "89ec3062-8e03-5f66-a339-723bd72d03c1"
tags:
  - created_from_open_prs
  - rule_status_modified
  - pr_author_markmsublime