name: "PR# 3094 - Google Classroom Spoofing With WhatsApp Contact Information"
description: "Detects messages impersonating Google Classroom notifications that contain WhatsApp contact information, likely attempting to redirect victims to out-of-band communication channels for social engineering attacks."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and sender.email.email == "no-reply@classroom.google.com"
  and (
    regex.icontains(body.current_thread.text, '\bWhatsapp:?.[:0-9+ ]{7,20}\b')
    or (
      strings.icontains(body.current_thread.text, "WhatsApp")
      and strings.icontains(body.current_thread.text, "invited")
    )
  )

attack_types:
  - "Callback Phishing"
  - "BEC/Fraud"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Out of band pivot"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Sender analysis"
id: "8e931efb-2d86-58b6-ae0e-2a7c1fd11c97"
tags:
  - created_from_open_prs
  - rule_status_added
  - pr_author_IndiaAce
references:
  - https://github.com/sublime-security/sublime-rules/pull/3094