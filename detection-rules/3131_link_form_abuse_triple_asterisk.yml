name: "PR# 3131 - Link: /index.php enclosed in three asterisks"
description: "Detects messages containing a specific pattern of triple asterisks surrounding HTTP links that point to PHP index pages with query parameters, indicating potential malicious behavior. This specific pattern has been observed within messages leading to FakeAV/Tech Support scams."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and strings.count(body.current_thread.text, '* * *') == 2
  and strings.contains(body.current_thread.text, ': http')
  and strings.contains(body.current_thread.text, '/index.php?')
  and regex.icontains(body.current_thread.text, '\* \* \*(?:[^\r\n]+|[\r\n][^\r\n]*): https?:\/\/.*\/index\.php\?[a-z0-9]+(?:[^\r\n]+|[\r\n][^\r\n]*)\* \* \*')
attack_types:
  - "Malware/Ransomware"
  - "Callback Phishing"
tactics_and_techniques:
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "URL analysis"
id: "a411d860-8114-53b1-a6f8-76f995427a12"
tags:
  - created_from_open_prs
  - rule_status_modified
  - pr_author_zoomequipd
references:
  - https://github.com/sublime-security/sublime-rules/pull/3131