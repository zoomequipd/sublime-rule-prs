name: "PR# 3710 - Subject: Suspicious Bracketed Reference"
description: "Detects messages with subject lines containing bracketed patterns that follow a specific format with repeated characters, numeric sequences, and structured tracking identifiers commonly used in malicious automated messaging systems."
type: "rule"
severity: "high"
source: |
  type.inbound
  and strings.contains(subject.base, '[')
  and strings.ends_with(subject.base, ']')
  and any(regex.extract(subject.base,
                        '\[(?P<first>.)(?P<second>.)\-(?P<second_part>[^\-]+)\-(?P<third_section>[^\]]+)\]$'
          ),
          .named_groups["first"] == .named_groups["second"]
          and regex.match(.named_groups["second_part"], '^\d+$')
          and regex.contains(.named_groups["third_section"], '\d+$')
          and strings.istarts_with(.named_groups["third_section"],
                                   .named_groups["first"]
          )
  )
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Evasion"
  - "Impersonation: Brand"
detection_methods:
  - "Header analysis"
  - "Content analysis"
id: "5c261efc-4d9a-574d-bdbe-5561f66c6667"
tags:
  - created_from_open_prs
  - rule_status_added
  - pr_author_zoomequipd
references:
  - https://github.com/sublime-security/sublime-rules/pull/3710