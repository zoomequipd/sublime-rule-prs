name: "PR# 2884 - Notion suspicious file share"
description: |
  Message contains a notion link that contains suspicious terms. You 
  may need to deactivate or fork this rule if your organization uses 
  Notion.
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(body.links,
          .href_url.domain.root_domain in~ ("notion.so", "notion.site")
          and (
            strings.ilike(.href_url.url,
                          '*shared*',
                          '*document*',
                          '*secure*',
                          '*office*',
                          '*important*',
                          '*wants-to*',
                          '*share*',
                          '*statement*'
            )
            or strings.ilike(.display_url.url,
                             '*shared*',
                             '*document*',
                             '*secure*',
                             '*office*',
                             '*important*',
                             '*wants-to*',
                             '*share*',
                             '*statement*'
            )
            or strings.ilike(.display_text,
                             '*shared*',
                             '*document*',
                             '*secure*',
                             '*office*',
                             '*important*',
                             '*wants-to*',
                             '*share*',
                             '*statement*'
            )
          )
  )
  and sender.email.domain.domain != 'mail.notion.so'
  and (
    profile.by_sender().prevalence in ("new", "outlier")
    or (
      profile.by_sender().any_messages_malicious_or_spam
      and not profile.by_sender().any_false_positives
    )
  )
tags:
  - "Attack surface reduction"
  - pr_author_brycampbell
  - created_from_open_prs
  - rule_status_modified
attack_types:
  - "Credential Phishing"
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Evasion"
  - "Free file host"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
  - "URL analysis"
id: "3edb0b68-d0d8-528f-9701-0262a7bf06e0"
references:
  - https://github.com/sublime-security/sublime-rules/pull/2884