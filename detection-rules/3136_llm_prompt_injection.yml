name: "Prompt Injection: Hidden content to bypass LLM analysis"
description: "Identifies messages which add prompt text to attempt to bypass LLM detection / analysis."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and not strings.icontains(body.plain.raw, body.html.raw)
  and strings.icontains(body.plain.raw, "Before answering")
  and strings.icontains(subject.subject, "login expiry")

attack_types:
  - "Callback Phishing"
  - "Credential Phishing"
  - "Extortion"
  - "Malware/Ransomware"
  - "Spam"
  - "BEC/Fraud"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
detection_methods:
  - "Header analysis"
  - "HTML analysis"
  - "Content analysis"
id: "b6009874-2aeb-5cef-a4c8-10353bacb0f7"
testing_pr: 3136
testing_sha: 012ef33ee774f072b09b69894ca757f87e8da5f4