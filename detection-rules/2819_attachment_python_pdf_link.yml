name: "PR# 2819 - Attachment: Python generated PDF with link"
description: |
  The PDF attachment was created with a Python-based script and contains one or more links. These techniques were used by PikaBot, among others.
authors:
  - twitter: "affje0x65"
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(attachments,
          .file_extension == "pdf"
          and any(file.explode(.),
                  any(.scan.strings.strings,
                      // create the raw PDF from code with this tools
                      strings.ilike(.,
                                    "*ReportLab*",
                                    "*pypdf*",
                                    "*pypdf2",
                                    "*pikepdf*",
                                    "*PyMuPDF*",
                                    "*IronPDF*"
                      )
                      // create an intermediate format and convert it to PDF
                      or strings.ilike(., "*pdfkit*", "*xhtml2pdf*", "*pdflatex*")
                      // image to pdf
                      or strings.ilike(.,
                                       "*img2pdf*",
                                       "*sphinxcontrib-svg2pdfconverter*"
                      )
                  )
          )
          and any(file.explode(.), length(.scan.url.urls) > 0)
  )
tags:
  - "Attack surface reduction"
  - pr_author_aidenmitchell
  - created_from_open_prs
  - rule_status_modified
tactics_and_techniques:
  - "Evasion"
  - "PDF"
detection_methods:
  - "File analysis"
id: "ba97d8f9-ccef-594c-a3dd-2562a8241255"
references:
  - https://github.com/sublime-security/sublime-rules/pull/2819