name: "PR# 3226 - Sendgrid voicemail phish"
description: |
  The message may contain a fake voicemail notification being sent via Sendgrid.
reference:
  - "https://krebsonsecurity.com/2020/08/sendgrid-under-siege-from-hacked-accounts/comment-page-1/"
type: "rule"
severity: "high"
source: |
  type.inbound
  and headers.return_path.domain.domain == 'sendgrid.net'
  and (
    regex.icontains(strings.replace_confusables(subject.subject),
                    'v[o0][il1]cema[il1][li1]',
                    'v[o0][il1]ce message'
    )
    or any(ml.nlu_classifier(body.current_thread.text).topics,
           .name == "Voicemail Call and Missed Call Notifications"
           and .confidence == "high"
    )
  )
  and any(ml.nlu_classifier(body.current_thread.text).intents,
          .name not in ("benign")
  )
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
id: "f7870662-d606-5cb7-abeb-dbc621fb70ee"
tags:
  - created_from_open_prs
  - rule_status_modified
  - pr_author_zoomequipd
references:
  - https://github.com/sublime-security/sublime-rules/pull/3226