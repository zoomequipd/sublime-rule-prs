name: "PR# 3678 - VIP spoofing: Contact information in body without reply chain"
description: "Detects messages containing VIP contact information (name and email address) in the body content without proper email thread references, indicating potential impersonation of organizational VIPs."
type: "rule"
severity: "high"
source: |
  type.inbound
  and (length(headers.references) == 0 or headers.in_reply_to is null)
  and any($org_vips,
          1 of (
              strings.icontains(body.html.raw,
                  strings.concat(.display_name, " <")
              ),
              strings.icontains(body.html.raw,
                  strings.concat("<", .email, ">")
              ),
              strings.icontains(body.current_thread.text,
                  strings.concat(.display_name, " <")
              ),
              strings.icontains(body.current_thread.text,
                  strings.concat("<", .email, ">")
              ),
              strings.icontains(body.plain.raw,
                  strings.concat(.display_name, " <")
              ),
              strings.icontains(body.plain.raw,
                  strings.concat("<", .email, ">")
              ),
          )
  )
tags:
  - "Attack surface reduction"
  - pr_author_MSAdministrator
  - created_from_open_prs
  - rule_status_added
attack_types:
  - "BEC/Fraud"
tactics_and_techniques:
  - "Impersonation: VIP"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
id: "8fbef841-cf5e-5539-8212-a1ecf0b4a874"
references:
  - https://github.com/sublime-security/sublime-rules/pull/3678